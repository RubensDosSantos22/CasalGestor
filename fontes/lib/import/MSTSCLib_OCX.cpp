// ************************************************************************ //
// WARNING                                                                    
// -------                                                                    
// The types declared in this file were generated from data read from a       
// Type Library. If this type library is explicitly or indirectly (via        
// another type library referring to this type library) re-imported, or the   
// 'Refresh' command of the Type Library Editor activated while editing the   
// Type Library, the contents of this file will be regenerated and all        
// manual modifications will be lost.                                         
// ************************************************************************ //

// $Rev: 98350 $
// File generated on 31/03/2022 15:13:37 from Type Library described below.

// ************************************************************************  //
// Type Lib: C:\Windows\SysWOW64\mstscax.dll (1)
// LIBID: {8C11EFA1-92C3-11D1-BC1E-00C04FA31489}
// LCID: 0
// Helpfile: 
// HelpString: Microsoft Terminal Services Control Type Library
// DepndLst: 
//   (1) v2.0 stdole, (C:\Windows\SysWOW64\stdole2.tlb)
// SYS_KIND: SYS_WIN32
// Errors:
//   Error creating palette bitmap of (TMsTscAxNotSafeForScripting) : Registry key CLSID\{A41A4187-5A86-4E26-B40A-856F9035D9CB}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClientNotSafeForScripting) : Registry key CLSID\{7CACBD7B-0D99-468F-AC33-22E495C0AFE5}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient2NotSafeForScripting) : Registry key CLSID\{3523C2FB-4031-44E4-9A3B-F1E94986EE7F}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient2) : Registry key CLSID\{9059F30F-4EB1-4BD2-9FDC-36F43A218F4A}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient2a) : Registry key CLSID\{971127BB-259F-48C2-BD75-5F97A3331551}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient3NotSafeForScripting) : Registry key CLSID\{ACE575FD-1FCF-4074-9401-EBAB990FA9DE}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient3) : Registry key CLSID\{7584C670-2274-4EFB-B00B-D6AABA6D3850}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient3a) : Registry key CLSID\{6A6F4B83-45C5-4CA9-BDD9-0D81C12295E4}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient4NotSafeForScripting) : Registry key CLSID\{6AE29350-321B-42BE-BBE5-12FB5270C0DE}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient4) : Registry key CLSID\{4EDCB26C-D24C-4E72-AF07-B576699AC0DE}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient4a) : Registry key CLSID\{54CE37E0-9834-41AE-9896-4DAB69DC022B}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient5NotSafeForScripting) : Registry key CLSID\{4EB2F086-C818-447E-B32C-C51CE2B30D31}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient5) : Registry key CLSID\{4EB89FF4-7F78-4A0F-8B8D-2BF02E94E4B2}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient6NotSafeForScripting) : Registry key CLSID\{D2EA46A7-C2BF-426B-AF24-E19C44456399}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient6) : Registry key CLSID\{7390F3D8-0439-4C05-91E3-CF5CB290C3D0}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient7NotSafeForScripting) : Registry key CLSID\{54D38BF7-B1EF-4479-9674-1BD6EA465258}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient7) : Registry key CLSID\{A9D7038D-B5ED-472E-9C47-94BEA90A5910}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient8NotSafeForScripting) : Registry key CLSID\{A3BC03A0-041D-42E3-AD22-882B7865C9C5}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient8) : Registry key CLSID\{5F681803-2900-4C43-A1CC-CF405404A676}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient9NotSafeForScripting) : Registry key CLSID\{8B918B82-7985-4C24-89DF-C33AD2BBFBCD}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient9) : Registry key CLSID\{301B94BA-5D25-4A12-BFFE-3B6E7A616585}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient10NotSafeForScripting) : Registry key CLSID\{A0C63C30-F08D-4AB4-907C-34905D770C7D}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient10) : Registry key CLSID\{C0EFA91A-EEB7-41C7-97FA-F0ED645EFB24}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient11NotSafeForScripting) : Registry key CLSID\{1DF7C823-B2D4-4B54-975A-F2AC5D7CF8B8}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TMsRdpClient11) : Registry key CLSID\{22A7E88C-5BF5-4DE6-B687-60F7331DF190}\ToolboxBitmap32 not found
//   Error creating palette bitmap of (TRemoteDesktopClient) : Registry key CLSID\{EAB16C5D-EED1-4E95-868B-0FBA1B42C092}\ToolboxBitmap32 not found
// ************************************************************************ //

#include <vcl.h>
#pragma hdrstop

#include <Vcl.OleCtrls.hpp>
#include <Vcl.OleServer.hpp>
#if defined(USING_ATL)
#include <atl\atlvcl.h>
#endif

#pragma option -w-8122
#include "MSTSCLib_OCX.h"

#if !defined(__PRAGMA_PACKAGE_SMART_INIT)
#define      __PRAGMA_PACKAGE_SMART_INIT
#pragma package(smart_init)
#endif

namespace Mstsclib_tlb
{



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsTscAxNotSafeForScripting which
// allows "Microsoft Terminal Services Client Control - version 1" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsTscAxNotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsTscAxNotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xA41A4187, 0x5A86, 0x4E26,{ 0xB4, 0x0A, 0x85,0x6F, 0x90, 0x35,0xD9, 0xCB} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsTscAxNotSafeForScripting::DEF_CTL_INTF = {0x8C11EFAE, 0x92C3, 0x11D1,{ 0xBC, 0x1E, 0x00,0xC0, 0x4F, 0xA3,0x14, 0x89} };
TNoParam TMsTscAxNotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsTscAxNotSafeForScripting *)
{
   delete new TMsTscAxNotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsTscAxNotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsTscAxNotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsTscAxDisp __fastcall TMsTscAxNotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsTscAxNotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsTscAxNotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsTscAxNotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsTscAxNotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                  BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsTscAxNotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsTscAxNotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsTscAxNotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

IMsTscAxPtr& TMsTscAx::GetDefaultInterface()
{
  if (!m_DefaultIntf)
    Connect();
  return m_DefaultIntf;
}

_di_IUnknown __fastcall TMsTscAx::GetDunk()
{
  _di_IUnknown diUnk;
  if (m_DefaultIntf) {
    IUnknownPtr punk = m_DefaultIntf;
    diUnk = LPUNKNOWN(punk);
  }
  return diUnk;
}

void __fastcall TMsTscAx::Connect()
{
  if (!m_DefaultIntf) {
    _di_IUnknown punk = GetServer();
    m_DefaultIntf = punk;
    if (ServerData->EventIID != GUID_NULL)
      ConnectEvents(GetDunk());
  }
}

void __fastcall TMsTscAx::Disconnect()
{
  if (m_DefaultIntf) {

    if (ServerData->EventIID != GUID_NULL)
      DisconnectEvents(GetDunk());
    m_DefaultIntf.Reset();
  }
}

void __fastcall TMsTscAx::BeforeDestruction()
{
  Disconnect();
}

void __fastcall TMsTscAx::ConnectTo(IMsTscAxPtr intf)
{
  Disconnect();
  m_DefaultIntf = intf;
  if (ServerData->EventIID != GUID_NULL)
    ConnectEvents(GetDunk());
}

void __fastcall TMsTscAx::InitServerData()
{
  static Vcl::Oleserver::TServerData sd;
  sd.ClassID = CLSID_MsTscAx;
  sd.IntfIID = __uuidof(IMsTscAx);
  sd.EventIID= __uuidof(IMsTscAxEvents);
  ServerData = &sd;
}

void __fastcall TMsTscAx::InvokeEvent(int id, Vcl::Oleserver::TVariantArray& params)
{
  switch(id)
  {
    case 1: {
      if (OnConnecting) {
        (OnConnecting)(this);
      }
      break;
      }
    case 2: {
      if (OnConnected) {
        (OnConnected)(this);
      }
      break;
      }
    case 3: {
      if (OnLoginComplete) {
        (OnLoginComplete)(this);
      }
      break;
      }
    case 4: {
      if (OnDisconnected) {
        (OnDisconnected)(this, params[0]);
      }
      break;
      }
    case 5: {
      if (OnEnterFullScreenMode) {
        (OnEnterFullScreenMode)(this);
      }
      break;
      }
    case 6: {
      if (OnLeaveFullScreenMode) {
        (OnLeaveFullScreenMode)(this);
      }
      break;
      }
    case 7: {
      if (OnChannelReceivedData) {
        (OnChannelReceivedData)(this, params[0].bstrVal, params[1].bstrVal);
      }
      break;
      }
    case 8: {
      if (OnRequestGoFullScreen) {
        (OnRequestGoFullScreen)(this);
      }
      break;
      }
    case 9: {
      if (OnRequestLeaveFullScreen) {
        (OnRequestLeaveFullScreen)(this);
      }
      break;
      }
    case 10: {
      if (OnFatalError) {
        (OnFatalError)(this, params[0]);
      }
      break;
      }
    case 11: {
      if (OnWarning) {
        (OnWarning)(this, params[0]);
      }
      break;
      }
    case 12: {
      if (OnRemoteDesktopSizeChange) {
        (OnRemoteDesktopSizeChange)(this, params[0], params[1]);
      }
      break;
      }
    case 13: {
      if (OnIdleTimeoutNotification) {
        (OnIdleTimeoutNotification)(this);
      }
      break;
      }
    case 14: {
      if (OnRequestContainerMinimize) {
        (OnRequestContainerMinimize)(this);
      }
      break;
      }
    case 15: {
      if (OnConfirmClose) {
        (OnConfirmClose)(this);
      }
      break;
      }
    case 16: {
      if (OnReceivedTSPublicKey) {
        (OnReceivedTSPublicKey)(this, params[0].bstrVal);
      }
      break;
      }
    case 17: {
      if (OnAutoReconnecting) {
        (OnAutoReconnecting)(this, params[0], params[1]);
      }
      break;
      }
    case 18: {
      if (OnAuthenticationWarningDisplayed) {
        (OnAuthenticationWarningDisplayed)(this);
      }
      break;
      }
    case 19: {
      if (OnAuthenticationWarningDismissed) {
        (OnAuthenticationWarningDismissed)(this);
      }
      break;
      }
    case 20: {
      if (OnRemoteProgramResult) {
        (OnRemoteProgramResult)(this, params[0].bstrVal, (Mstsclib_tlb::RemoteProgramResult)(int)params[1], params[2]);
      }
      break;
      }
    case 21: {
      if (OnRemoteProgramDisplayed) {
        (OnRemoteProgramDisplayed)(this, params[0], params[1]);
      }
      break;
      }
    case 29: {
      if (OnRemoteWindowDisplayed) {
        (OnRemoteWindowDisplayed)(this, params[0], params[1], (Mstsclib_tlb::RemoteWindowDisplayedAttribute)(int)params[2]);
      }
      break;
      }
    case 22: {
      if (OnLogonError) {
        (OnLogonError)(this, params[0]);
      }
      break;
      }
    case 23: {
      if (OnFocusReleased) {
        (OnFocusReleased)(this, params[0]);
      }
      break;
      }
    case 24: {
      if (OnUserNameAcquired) {
        (OnUserNameAcquired)(this, params[0].bstrVal);
      }
      break;
      }
    case 26: {
      if (OnMouseInputModeChanged) {
        (OnMouseInputModeChanged)(this, params[0]);
      }
      break;
      }
    case 28: {
      if (OnServiceMessageReceived) {
        (OnServiceMessageReceived)(this, params[0].bstrVal);
      }
      break;
      }
    case 30: {
      if (OnConnectionBarPullDown) {
        (OnConnectionBarPullDown)(this);
      }
      break;
      }
    case 32: {
      if (OnNetworkStatusChanged) {
        (OnNetworkStatusChanged)(this, params[0], params[1], params[2]);
      }
      break;
      }
    case 35: {
      if (OnDevicesButtonPressed) {
        (OnDevicesButtonPressed)(this);
      }
      break;
      }
    case 33: {
      if (OnAutoReconnected) {
        (OnAutoReconnected)(this);
      }
      break;
      }
    case 34: {
      if (OnAutoReconnecting2) {
        (OnAutoReconnecting2)(this, params[0], params[1], params[2], params[3]);
      }
      break;
      }
    default:
      break;
  }
}

void __fastcall TMsTscAx::Connect1(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsTscAx::Disconnect1(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsTscAx::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsTscAx::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsTscAx::set_Server(BSTR pServer/*[in]*/)
{
  GetDefaultInterface()->set_Server(pServer/*[in]*/);
}

BSTR __fastcall TMsTscAx::get_Server(void)
{
  BSTR pServer = 0;
  OLECHECK(GetDefaultInterface()->get_Server((BSTR*)&pServer));
  return pServer;
}

void __fastcall TMsTscAx::set_Domain(BSTR pDomain/*[in]*/)
{
  GetDefaultInterface()->set_Domain(pDomain/*[in]*/);
}

BSTR __fastcall TMsTscAx::get_Domain(void)
{
  BSTR pDomain = 0;
  OLECHECK(GetDefaultInterface()->get_Domain((BSTR*)&pDomain));
  return pDomain;
}

void __fastcall TMsTscAx::set_UserName(BSTR pUserName/*[in]*/)
{
  GetDefaultInterface()->set_UserName(pUserName/*[in]*/);
}

BSTR __fastcall TMsTscAx::get_UserName(void)
{
  BSTR pUserName = 0;
  OLECHECK(GetDefaultInterface()->get_UserName((BSTR*)&pUserName));
  return pUserName;
}

void __fastcall TMsTscAx::set_DisconnectedText(BSTR pDisconnectedText/*[in]*/)
{
  GetDefaultInterface()->set_DisconnectedText(pDisconnectedText/*[in]*/);
}

BSTR __fastcall TMsTscAx::get_DisconnectedText(void)
{
  BSTR pDisconnectedText = 0;
  OLECHECK(GetDefaultInterface()->get_DisconnectedText((BSTR*)&pDisconnectedText));
  return pDisconnectedText;
}

void __fastcall TMsTscAx::set_ConnectingText(BSTR pConnectingText/*[in]*/)
{
  GetDefaultInterface()->set_ConnectingText(pConnectingText/*[in]*/);
}

BSTR __fastcall TMsTscAx::get_ConnectingText(void)
{
  BSTR pConnectingText = 0;
  OLECHECK(GetDefaultInterface()->get_ConnectingText((BSTR*)&pConnectingText));
  return pConnectingText;
}

short __fastcall TMsTscAx::get_Connected(void)
{
  short pIsConnected;
  OLECHECK(GetDefaultInterface()->get_Connected((short*)&pIsConnected));
  return pIsConnected;
}

void __fastcall TMsTscAx::set_DesktopWidth(long pVal/*[in]*/)
{
  GetDefaultInterface()->set_DesktopWidth(pVal/*[in]*/);
}

long __fastcall TMsTscAx::get_DesktopWidth(void)
{
  long pVal;
  OLECHECK(GetDefaultInterface()->get_DesktopWidth((long*)&pVal));
  return pVal;
}

void __fastcall TMsTscAx::set_DesktopHeight(long pVal/*[in]*/)
{
  GetDefaultInterface()->set_DesktopHeight(pVal/*[in]*/);
}

long __fastcall TMsTscAx::get_DesktopHeight(void)
{
  long pVal;
  OLECHECK(GetDefaultInterface()->get_DesktopHeight((long*)&pVal));
  return pVal;
}

void __fastcall TMsTscAx::set_StartConnected(long pfStartConnected/*[in]*/)
{
  GetDefaultInterface()->set_StartConnected(pfStartConnected/*[in]*/);
}

long __fastcall TMsTscAx::get_StartConnected(void)
{
  long pfStartConnected;
  OLECHECK(GetDefaultInterface()->get_StartConnected((long*)&pfStartConnected));
  return pfStartConnected;
}

long __fastcall TMsTscAx::get_HorizontalScrollBarVisible(void)
{
  long pfHScrollVisible;
  OLECHECK(GetDefaultInterface()->get_HorizontalScrollBarVisible((long*)&pfHScrollVisible));
  return pfHScrollVisible;
}

long __fastcall TMsTscAx::get_VerticalScrollBarVisible(void)
{
  long pfVScrollVisible;
  OLECHECK(GetDefaultInterface()->get_VerticalScrollBarVisible((long*)&pfVScrollVisible));
  return pfVScrollVisible;
}

void __fastcall TMsTscAx::set_FullScreenTitle(BSTR Param1/*[in]*/)
{
  GetDefaultInterface()->set_FullScreenTitle(Param1/*[in]*/);
}

long __fastcall TMsTscAx::get_CipherStrength(void)
{
  long pCipherStrength;
  OLECHECK(GetDefaultInterface()->get_CipherStrength((long*)&pCipherStrength));
  return pCipherStrength;
}

BSTR __fastcall TMsTscAx::get_Version(void)
{
  BSTR pVersion = 0;
  OLECHECK(GetDefaultInterface()->get_Version((BSTR*)&pVersion));
  return pVersion;
}

long __fastcall TMsTscAx::get_SecuredSettingsEnabled(void)
{
  long pSecuredSettingsEnabled;
  OLECHECK(GetDefaultInterface()->get_SecuredSettingsEnabled((long*)&pSecuredSettingsEnabled));
  return pSecuredSettingsEnabled;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsTscAx::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsTscAx::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsTscAx::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClientNotSafeForScripting which
// allows "Microsoft RDP Client Control - version 2" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClientNotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClientNotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x7CACBD7B, 0x0D99, 0x468F,{ 0xAC, 0x33, 0x22,0xE4, 0x95, 0xC0,0xAF, 0xE5} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClientNotSafeForScripting::DEF_CTL_INTF = {0x92B4A539, 0x7115, 0x4B7C,{ 0xA5, 0xA9, 0xE5,0xD9, 0xEF, 0xC2,0x78, 0x0A} };
TNoParam TMsRdpClientNotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClientNotSafeForScripting *)
{
   delete new TMsRdpClientNotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClientNotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClientNotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClientDisp __fastcall TMsRdpClientNotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClientNotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClientNotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClientNotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClientNotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                      BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClientNotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                          long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClientNotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClientNotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClientNotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClientNotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClientNotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClientNotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClientNotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

IMsRdpClientPtr& TMsRdpClient::GetDefaultInterface()
{
  if (!m_DefaultIntf)
    Connect();
  return m_DefaultIntf;
}

_di_IUnknown __fastcall TMsRdpClient::GetDunk()
{
  _di_IUnknown diUnk;
  if (m_DefaultIntf) {
    IUnknownPtr punk = m_DefaultIntf;
    diUnk = LPUNKNOWN(punk);
  }
  return diUnk;
}

void __fastcall TMsRdpClient::Connect()
{
  if (!m_DefaultIntf) {
    _di_IUnknown punk = GetServer();
    m_DefaultIntf = punk;
    if (ServerData->EventIID != GUID_NULL)
      ConnectEvents(GetDunk());
  }
}

void __fastcall TMsRdpClient::Disconnect()
{
  if (m_DefaultIntf) {

    if (ServerData->EventIID != GUID_NULL)
      DisconnectEvents(GetDunk());
    m_DefaultIntf.Reset();
  }
}

void __fastcall TMsRdpClient::BeforeDestruction()
{
  Disconnect();
}

void __fastcall TMsRdpClient::ConnectTo(IMsRdpClientPtr intf)
{
  Disconnect();
  m_DefaultIntf = intf;
  if (ServerData->EventIID != GUID_NULL)
    ConnectEvents(GetDunk());
}

void __fastcall TMsRdpClient::InitServerData()
{
  static Vcl::Oleserver::TServerData sd;
  sd.ClassID = CLSID_MsRdpClient;
  sd.IntfIID = __uuidof(IMsRdpClient);
  sd.EventIID= __uuidof(IMsTscAxEvents);
  ServerData = &sd;
}

void __fastcall TMsRdpClient::InvokeEvent(int id, Vcl::Oleserver::TVariantArray& params)
{
  switch(id)
  {
    case 1: {
      if (OnConnecting) {
        (OnConnecting)(this);
      }
      break;
      }
    case 2: {
      if (OnConnected) {
        (OnConnected)(this);
      }
      break;
      }
    case 3: {
      if (OnLoginComplete) {
        (OnLoginComplete)(this);
      }
      break;
      }
    case 4: {
      if (OnDisconnected) {
        (OnDisconnected)(this, params[0]);
      }
      break;
      }
    case 5: {
      if (OnEnterFullScreenMode) {
        (OnEnterFullScreenMode)(this);
      }
      break;
      }
    case 6: {
      if (OnLeaveFullScreenMode) {
        (OnLeaveFullScreenMode)(this);
      }
      break;
      }
    case 7: {
      if (OnChannelReceivedData) {
        (OnChannelReceivedData)(this, params[0].bstrVal, params[1].bstrVal);
      }
      break;
      }
    case 8: {
      if (OnRequestGoFullScreen) {
        (OnRequestGoFullScreen)(this);
      }
      break;
      }
    case 9: {
      if (OnRequestLeaveFullScreen) {
        (OnRequestLeaveFullScreen)(this);
      }
      break;
      }
    case 10: {
      if (OnFatalError) {
        (OnFatalError)(this, params[0]);
      }
      break;
      }
    case 11: {
      if (OnWarning) {
        (OnWarning)(this, params[0]);
      }
      break;
      }
    case 12: {
      if (OnRemoteDesktopSizeChange) {
        (OnRemoteDesktopSizeChange)(this, params[0], params[1]);
      }
      break;
      }
    case 13: {
      if (OnIdleTimeoutNotification) {
        (OnIdleTimeoutNotification)(this);
      }
      break;
      }
    case 14: {
      if (OnRequestContainerMinimize) {
        (OnRequestContainerMinimize)(this);
      }
      break;
      }
    case 15: {
      if (OnConfirmClose) {
        (OnConfirmClose)(this);
      }
      break;
      }
    case 16: {
      if (OnReceivedTSPublicKey) {
        (OnReceivedTSPublicKey)(this, params[0].bstrVal);
      }
      break;
      }
    case 17: {
      if (OnAutoReconnecting) {
        (OnAutoReconnecting)(this, params[0], params[1]);
      }
      break;
      }
    case 18: {
      if (OnAuthenticationWarningDisplayed) {
        (OnAuthenticationWarningDisplayed)(this);
      }
      break;
      }
    case 19: {
      if (OnAuthenticationWarningDismissed) {
        (OnAuthenticationWarningDismissed)(this);
      }
      break;
      }
    case 20: {
      if (OnRemoteProgramResult) {
        (OnRemoteProgramResult)(this, params[0].bstrVal, (Mstsclib_tlb::RemoteProgramResult)(int)params[1], params[2]);
      }
      break;
      }
    case 21: {
      if (OnRemoteProgramDisplayed) {
        (OnRemoteProgramDisplayed)(this, params[0], params[1]);
      }
      break;
      }
    case 29: {
      if (OnRemoteWindowDisplayed) {
        (OnRemoteWindowDisplayed)(this, params[0], params[1], (Mstsclib_tlb::RemoteWindowDisplayedAttribute)(int)params[2]);
      }
      break;
      }
    case 22: {
      if (OnLogonError) {
        (OnLogonError)(this, params[0]);
      }
      break;
      }
    case 23: {
      if (OnFocusReleased) {
        (OnFocusReleased)(this, params[0]);
      }
      break;
      }
    case 24: {
      if (OnUserNameAcquired) {
        (OnUserNameAcquired)(this, params[0].bstrVal);
      }
      break;
      }
    case 26: {
      if (OnMouseInputModeChanged) {
        (OnMouseInputModeChanged)(this, params[0]);
      }
      break;
      }
    case 28: {
      if (OnServiceMessageReceived) {
        (OnServiceMessageReceived)(this, params[0].bstrVal);
      }
      break;
      }
    case 30: {
      if (OnConnectionBarPullDown) {
        (OnConnectionBarPullDown)(this);
      }
      break;
      }
    case 32: {
      if (OnNetworkStatusChanged) {
        (OnNetworkStatusChanged)(this, params[0], params[1], params[2]);
      }
      break;
      }
    case 35: {
      if (OnDevicesButtonPressed) {
        (OnDevicesButtonPressed)(this);
      }
      break;
      }
    case 33: {
      if (OnAutoReconnected) {
        (OnAutoReconnected)(this);
      }
      break;
      }
    case 34: {
      if (OnAutoReconnecting2) {
        (OnAutoReconnecting2)(this, params[0], params[1], params[2], params[3]);
      }
      break;
      }
    default:
      break;
  }
}

void __fastcall TMsRdpClient::Connect1(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient::Disconnect1(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                       long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

void __fastcall TMsRdpClient::set_Server(BSTR pServer/*[in]*/)
{
  GetDefaultInterface()->set_Server(pServer/*[in]*/);
}

BSTR __fastcall TMsRdpClient::get_Server(void)
{
  BSTR pServer = 0;
  OLECHECK(GetDefaultInterface()->get_Server((BSTR*)&pServer));
  return pServer;
}

void __fastcall TMsRdpClient::set_Domain(BSTR pDomain/*[in]*/)
{
  GetDefaultInterface()->set_Domain(pDomain/*[in]*/);
}

BSTR __fastcall TMsRdpClient::get_Domain(void)
{
  BSTR pDomain = 0;
  OLECHECK(GetDefaultInterface()->get_Domain((BSTR*)&pDomain));
  return pDomain;
}

void __fastcall TMsRdpClient::set_UserName(BSTR pUserName/*[in]*/)
{
  GetDefaultInterface()->set_UserName(pUserName/*[in]*/);
}

BSTR __fastcall TMsRdpClient::get_UserName(void)
{
  BSTR pUserName = 0;
  OLECHECK(GetDefaultInterface()->get_UserName((BSTR*)&pUserName));
  return pUserName;
}

void __fastcall TMsRdpClient::set_DisconnectedText(BSTR pDisconnectedText/*[in]*/)
{
  GetDefaultInterface()->set_DisconnectedText(pDisconnectedText/*[in]*/);
}

BSTR __fastcall TMsRdpClient::get_DisconnectedText(void)
{
  BSTR pDisconnectedText = 0;
  OLECHECK(GetDefaultInterface()->get_DisconnectedText((BSTR*)&pDisconnectedText));
  return pDisconnectedText;
}

void __fastcall TMsRdpClient::set_ConnectingText(BSTR pConnectingText/*[in]*/)
{
  GetDefaultInterface()->set_ConnectingText(pConnectingText/*[in]*/);
}

BSTR __fastcall TMsRdpClient::get_ConnectingText(void)
{
  BSTR pConnectingText = 0;
  OLECHECK(GetDefaultInterface()->get_ConnectingText((BSTR*)&pConnectingText));
  return pConnectingText;
}

short __fastcall TMsRdpClient::get_Connected(void)
{
  short pIsConnected;
  OLECHECK(GetDefaultInterface()->get_Connected((short*)&pIsConnected));
  return pIsConnected;
}

void __fastcall TMsRdpClient::set_DesktopWidth(long pVal/*[in]*/)
{
  GetDefaultInterface()->set_DesktopWidth(pVal/*[in]*/);
}

long __fastcall TMsRdpClient::get_DesktopWidth(void)
{
  long pVal;
  OLECHECK(GetDefaultInterface()->get_DesktopWidth((long*)&pVal));
  return pVal;
}

void __fastcall TMsRdpClient::set_DesktopHeight(long pVal/*[in]*/)
{
  GetDefaultInterface()->set_DesktopHeight(pVal/*[in]*/);
}

long __fastcall TMsRdpClient::get_DesktopHeight(void)
{
  long pVal;
  OLECHECK(GetDefaultInterface()->get_DesktopHeight((long*)&pVal));
  return pVal;
}

void __fastcall TMsRdpClient::set_StartConnected(long pfStartConnected/*[in]*/)
{
  GetDefaultInterface()->set_StartConnected(pfStartConnected/*[in]*/);
}

long __fastcall TMsRdpClient::get_StartConnected(void)
{
  long pfStartConnected;
  OLECHECK(GetDefaultInterface()->get_StartConnected((long*)&pfStartConnected));
  return pfStartConnected;
}

long __fastcall TMsRdpClient::get_HorizontalScrollBarVisible(void)
{
  long pfHScrollVisible;
  OLECHECK(GetDefaultInterface()->get_HorizontalScrollBarVisible((long*)&pfHScrollVisible));
  return pfHScrollVisible;
}

long __fastcall TMsRdpClient::get_VerticalScrollBarVisible(void)
{
  long pfVScrollVisible;
  OLECHECK(GetDefaultInterface()->get_VerticalScrollBarVisible((long*)&pfVScrollVisible));
  return pfVScrollVisible;
}

void __fastcall TMsRdpClient::set_FullScreenTitle(BSTR Param1/*[in]*/)
{
  GetDefaultInterface()->set_FullScreenTitle(Param1/*[in]*/);
}

long __fastcall TMsRdpClient::get_CipherStrength(void)
{
  long pCipherStrength;
  OLECHECK(GetDefaultInterface()->get_CipherStrength((long*)&pCipherStrength));
  return pCipherStrength;
}

BSTR __fastcall TMsRdpClient::get_Version(void)
{
  BSTR pVersion = 0;
  OLECHECK(GetDefaultInterface()->get_Version((BSTR*)&pVersion));
  return pVersion;
}

long __fastcall TMsRdpClient::get_SecuredSettingsEnabled(void)
{
  long pSecuredSettingsEnabled;
  OLECHECK(GetDefaultInterface()->get_SecuredSettingsEnabled((long*)&pSecuredSettingsEnabled));
  return pSecuredSettingsEnabled;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

void __fastcall TMsRdpClient::set_ColorDepth(long pcolorDepth/*[in]*/)
{
  GetDefaultInterface()->set_ColorDepth(pcolorDepth/*[in]*/);
}

long __fastcall TMsRdpClient::get_ColorDepth(void)
{
  long pcolorDepth;
  OLECHECK(GetDefaultInterface()->get_ColorDepth((long*)&pcolorDepth));
  return pcolorDepth;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ExtendedDisconnectReasonCode __fastcall TMsRdpClient::get_ExtendedDisconnectReason(void)
{
  Mstsclib_tlb::ExtendedDisconnectReasonCode pExtendedDisconnectReason;
  OLECHECK(GetDefaultInterface()->get_ExtendedDisconnectReason((Mstsclib_tlb::ExtendedDisconnectReasonCode*)&pExtendedDisconnectReason));
  return pExtendedDisconnectReason;
}

void __fastcall TMsRdpClient::set_FullScreen(VARIANT_BOOL pfFullScreen/*[in]*/)
{
  GetDefaultInterface()->set_FullScreen(pfFullScreen/*[in]*/);
}

VARIANT_BOOL __fastcall TMsRdpClient::get_FullScreen(void)
{
  VARIANT_BOOL pfFullScreen;
  OLECHECK(GetDefaultInterface()->get_FullScreen((VARIANT_BOOL*)&pfFullScreen));
  return pfFullScreen;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient2NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 3" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient2NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient2NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x3523C2FB, 0x4031, 0x44E4,{ 0x9A, 0x3B, 0xF1,0xE9, 0x49, 0x86,0xEE, 0x7F} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient2NotSafeForScripting::DEF_CTL_INTF = {0xE7E17DC4, 0x3B71, 0x4BA7,{ 0xA8, 0xE6, 0x28,0x1F, 0xFA, 0xDC,0xA2, 0x8F} };
TNoParam TMsRdpClient2NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient2NotSafeForScripting *)
{
   delete new TMsRdpClient2NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient2NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient2NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient2Disp __fastcall TMsRdpClient2NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient2NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient2NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient2NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient2NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient2NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient2NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient2NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient2NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient2NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient2NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient2NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient2NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient2NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient2 which
// allows "Microsoft RDP Client Control (redistributable) - version 3" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient2::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient2::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x9059F30F, 0x4EB1, 0x4BD2,{ 0x9F, 0xDC, 0x36,0xF4, 0x3A, 0x21,0x8F, 0x4A} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient2::DEF_CTL_INTF = {0xE7E17DC4, 0x3B71, 0x4BA7,{ 0xA8, 0xE6, 0x28,0x1F, 0xFA, 0xDC,0xA2, 0x8F} };
TNoParam TMsRdpClient2::OptParam;

static inline void ValidCtrCheck(TMsRdpClient2 *)
{
   delete new TMsRdpClient2((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient2::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient2::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient2Disp __fastcall TMsRdpClient2::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient2::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient2::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient2::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient2::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient2::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient2::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient2::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient2::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient2::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient2::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient2::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient2::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient2::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient2a which
// allows "Microsoft RDP Client Control (redistributable) - version 3a" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient2a::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient2a::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x971127BB, 0x259F, 0x48C2,{ 0xBD, 0x75, 0x5F,0x97, 0xA3, 0x33,0x15, 0x51} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient2a::DEF_CTL_INTF = {0xE7E17DC4, 0x3B71, 0x4BA7,{ 0xA8, 0xE6, 0x28,0x1F, 0xFA, 0xDC,0xA2, 0x8F} };
TNoParam TMsRdpClient2a::OptParam;

static inline void ValidCtrCheck(TMsRdpClient2a *)
{
   delete new TMsRdpClient2a((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient2a::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient2a::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient2Disp __fastcall TMsRdpClient2a::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient2a::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient2a::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient2a::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient2a::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient2a::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                         long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient2a::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient2a::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient2a::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient2a::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient2a::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient2a::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient2a::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient2a::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient3NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 4" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient3NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient3NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xACE575FD, 0x1FCF, 0x4074,{ 0x94, 0x01, 0xEB,0xAB, 0x99, 0x0F,0xA9, 0xDE} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient3NotSafeForScripting::DEF_CTL_INTF = {0x91B7CBC5, 0xA72E, 0x4FA0,{ 0x93, 0x00, 0xD6,0x47, 0xD7, 0xE8,0x97, 0xFF} };
TNoParam TMsRdpClient3NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient3NotSafeForScripting *)
{
   delete new TMsRdpClient3NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient3NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient3NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient3Disp __fastcall TMsRdpClient3NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient3NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient3NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient3NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient3NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient3NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient3NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient3NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient3NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient3NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient3NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient3NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient3NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient3NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient3NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient3 which
// allows "Microsoft RDP Client Control (redistributable) - version 4" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient3::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient3::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x7584C670, 0x2274, 0x4EFB,{ 0xB0, 0x0B, 0xD6,0xAA, 0xBA, 0x6D,0x38, 0x50} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient3::DEF_CTL_INTF = {0x91B7CBC5, 0xA72E, 0x4FA0,{ 0x93, 0x00, 0xD6,0x47, 0xD7, 0xE8,0x97, 0xFF} };
TNoParam TMsRdpClient3::OptParam;

static inline void ValidCtrCheck(TMsRdpClient3 *)
{
   delete new TMsRdpClient3((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient3::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient3::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient3Disp __fastcall TMsRdpClient3::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient3::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient3::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient3::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient3::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient3::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient3::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient3::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient3::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient3::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient3::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient3::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient3::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient3::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient3::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient3a which
// allows "Microsoft RDP Client Control (redistributable) - version 4a" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient3a::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient3a::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x6A6F4B83, 0x45C5, 0x4CA9,{ 0xBD, 0xD9, 0x0D,0x81, 0xC1, 0x22,0x95, 0xE4} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient3a::DEF_CTL_INTF = {0x91B7CBC5, 0xA72E, 0x4FA0,{ 0x93, 0x00, 0xD6,0x47, 0xD7, 0xE8,0x97, 0xFF} };
TNoParam TMsRdpClient3a::OptParam;

static inline void ValidCtrCheck(TMsRdpClient3a *)
{
   delete new TMsRdpClient3a((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient3a::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient3a::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient3Disp __fastcall TMsRdpClient3a::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient3a::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient3a::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient3a::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient3a::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient3a::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                         long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient3a::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient3a::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient3a::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient3a::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient3a::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient3a::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient3a::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient3a::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient3a::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient4NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 5" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient4NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient4NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x6AE29350, 0x321B, 0x42BE,{ 0xBB, 0xE5, 0x12,0xFB, 0x52, 0x70,0xC0, 0xDE} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient4NotSafeForScripting::DEF_CTL_INTF = {0x095E0738, 0xD97D, 0x488B,{ 0xB9, 0xF6, 0xDD,0x0E, 0x8D, 0x66,0xC0, 0xDE} };
TNoParam TMsRdpClient4NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient4NotSafeForScripting *)
{
   delete new TMsRdpClient4NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient4NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient4NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient4Disp __fastcall TMsRdpClient4NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient4NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient4NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient4NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient4NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient4NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient4NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient4NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient4NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient4NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient4NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient4NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient4NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient4NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient4NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient4NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient4 which
// allows "Microsoft RDP Client Control (redistributable) - version 5" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient4::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient4::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x4EDCB26C, 0xD24C, 0x4E72,{ 0xAF, 0x07, 0xB5,0x76, 0x69, 0x9A,0xC0, 0xDE} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient4::DEF_CTL_INTF = {0x095E0738, 0xD97D, 0x488B,{ 0xB9, 0xF6, 0xDD,0x0E, 0x8D, 0x66,0xC0, 0xDE} };
TNoParam TMsRdpClient4::OptParam;

static inline void ValidCtrCheck(TMsRdpClient4 *)
{
   delete new TMsRdpClient4((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient4::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient4::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient4Disp __fastcall TMsRdpClient4::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient4::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient4::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient4::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient4::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient4::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient4::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient4::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient4::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient4::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient4::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient4::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient4::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient4::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient4::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient4::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient4a which
// allows "Microsoft RDP Client Control (redistributable) - version 5a" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient4a::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient4a::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x54CE37E0, 0x9834, 0x41AE,{ 0x98, 0x96, 0x4D,0xAB, 0x69, 0xDC,0x02, 0x2B} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient4a::DEF_CTL_INTF = {0x095E0738, 0xD97D, 0x488B,{ 0xB9, 0xF6, 0xDD,0x0E, 0x8D, 0x66,0xC0, 0xDE} };
TNoParam TMsRdpClient4a::OptParam;

static inline void ValidCtrCheck(TMsRdpClient4a *)
{
   delete new TMsRdpClient4a((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient4a::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient4a::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient4Disp __fastcall TMsRdpClient4a::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient4a::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient4a::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient4a::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient4a::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient4a::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                         long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient4a::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient4a::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient4a::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient4a::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient4a::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient4a::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient4a::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient4a::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient4a::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient4a::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient5NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 6" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient5NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient5NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x4EB2F086, 0xC818, 0x447E,{ 0xB3, 0x2C, 0xC5,0x1C, 0xE2, 0xB3,0x0D, 0x31} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient5NotSafeForScripting::DEF_CTL_INTF = {0x4EB5335B, 0x6429, 0x477D,{ 0xB9, 0x22, 0xE0,0x6A, 0x28, 0xEC,0xD8, 0xBF} };
TNoParam TMsRdpClient5NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient5NotSafeForScripting *)
{
   delete new TMsRdpClient5NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient5NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient5NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient5Disp __fastcall TMsRdpClient5NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient5NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient5NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient5NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient5NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient5NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient5NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient5NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient5NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                      unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient5NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient5NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient5NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient5NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient5NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient5NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient5NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient5NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient5NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient5NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient5NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient5NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient5 which
// allows "Microsoft RDP Client Control (redistributable) - version 6" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient5::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient5::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x4EB89FF4, 0x7F78, 0x4A0F,{ 0x8B, 0x8D, 0x2B,0xF0, 0x2E, 0x94,0xE4, 0xB2} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient5::DEF_CTL_INTF = {0x4EB5335B, 0x6429, 0x477D,{ 0xB9, 0x22, 0xE0,0x6A, 0x28, 0xEC,0xD8, 0xBF} };
TNoParam TMsRdpClient5::OptParam;

static inline void ValidCtrCheck(TMsRdpClient5 *)
{
   delete new TMsRdpClient5((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient5::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient5::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient5Disp __fastcall TMsRdpClient5::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient5::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient5::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient5::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient5::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient5::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient5::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient5::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient5::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                   unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient5::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient5::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient5::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient5::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient5::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient5::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient5::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient5::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient5::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient5::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient5::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient5::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient6NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 7" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient6NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient6NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xD2EA46A7, 0xC2BF, 0x426B,{ 0xAF, 0x24, 0xE1,0x9C, 0x44, 0x45,0x63, 0x99} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient6NotSafeForScripting::DEF_CTL_INTF = {0xD43B7D80, 0x8517, 0x4B6D,{ 0x9E, 0xAC, 0x96,0xAD, 0x68, 0x00,0xD7, 0xF2} };
TNoParam TMsRdpClient6NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient6NotSafeForScripting *)
{
   delete new TMsRdpClient6NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient6NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient6NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient6Disp __fastcall TMsRdpClient6NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient6NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient6NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient6NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient6NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient6NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient6NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient6NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient6NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                      unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient6NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient6NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient6NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient6NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient6NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient6NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient6NotSafeForScripting::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient6NotSafeForScripting::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient6 which
// allows "Microsoft RDP Client Control (redistributable) - version 7" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient6::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient6::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x7390F3D8, 0x0439, 0x4C05,{ 0x91, 0xE3, 0xCF,0x5C, 0xB2, 0x90,0xC3, 0xD0} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient6::DEF_CTL_INTF = {0xD43B7D80, 0x8517, 0x4B6D,{ 0x9E, 0xAC, 0x96,0xAD, 0x68, 0x00,0xD7, 0xF2} };
TNoParam TMsRdpClient6::OptParam;

static inline void ValidCtrCheck(TMsRdpClient6 *)
{
   delete new TMsRdpClient6((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient6::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient6::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient6Disp __fastcall TMsRdpClient6::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient6::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient6::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient6::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient6::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient6::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient6::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient6::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient6::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                   unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient6::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient6::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient6::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient6::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient6::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient6::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient6::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient6::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient6::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient6::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient6::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient6::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient6::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient6::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient7NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 8" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient7NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient7NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x54D38BF7, 0xB1EF, 0x4479,{ 0x96, 0x74, 0x1B,0xD6, 0xEA, 0x46,0x52, 0x58} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient7NotSafeForScripting::DEF_CTL_INTF = {0xB2A5B5CE, 0x3461, 0x444A,{ 0x91, 0xD4, 0xAD,0xD2, 0x6D, 0x07,0x06, 0x38} };
TNoParam TMsRdpClient7NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient7NotSafeForScripting *)
{
   delete new TMsRdpClient7NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient7NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient7NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient7Disp __fastcall TMsRdpClient7NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient7NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient7NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient7NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient7NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient7NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient7NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient7NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient7NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                      unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient7NotSafeForScripting::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient7NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient7NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient7NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient7NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient7NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient7NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient7NotSafeForScripting::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient7 which
// allows "Microsoft RDP Client Control (redistributable) - version 8" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient7::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient7::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xA9D7038D, 0xB5ED, 0x472E,{ 0x9C, 0x47, 0x94,0xBE, 0xA9, 0x0A,0x59, 0x10} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient7::DEF_CTL_INTF = {0xB2A5B5CE, 0x3461, 0x444A,{ 0x91, 0xD4, 0xAD,0xD2, 0x6D, 0x07,0x06, 0x38} };
TNoParam TMsRdpClient7::OptParam;

static inline void ValidCtrCheck(TMsRdpClient7 *)
{
   delete new TMsRdpClient7((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient7::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient7::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient7Disp __fastcall TMsRdpClient7::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient7::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient7::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient7::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient7::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient7::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient7::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient7::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient7::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                   unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient7::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient7::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient7::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient7::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient7::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient7::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient7::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient7::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient7::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient7::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient7::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient7::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient7::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient7::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient7::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient7::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient7::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient7::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient7::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient8NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 9" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient8NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient8NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xA3BC03A0, 0x041D, 0x42E3,{ 0xAD, 0x22, 0x88,0x2B, 0x78, 0x65,0xC9, 0xC5} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient8NotSafeForScripting::DEF_CTL_INTF = {0x4247E044, 0x9271, 0x43A9,{ 0xBC, 0x49, 0xE2,0xAD, 0x9E, 0x85,0x5D, 0x62} };
TNoParam TMsRdpClient8NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient8NotSafeForScripting *)
{
   delete new TMsRdpClient8NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient8NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient8NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient8Disp __fastcall TMsRdpClient8NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient8NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient8NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient8NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient8NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient8NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient8NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient8NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient8NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                      unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient8NotSafeForScripting::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient8NotSafeForScripting::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient8NotSafeForScripting::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                                            unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient8NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient8NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient8NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient8NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient8NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient8NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient8NotSafeForScripting::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient8 which
// allows "Microsoft RDP Client Control (redistributable) - version 9" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient8::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient8::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x5F681803, 0x2900, 0x4C43,{ 0xA1, 0xCC, 0xCF,0x40, 0x54, 0x04,0xA6, 0x76} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient8::DEF_CTL_INTF = {0x4247E044, 0x9271, 0x43A9,{ 0xBC, 0x49, 0xE2,0xAD, 0x9E, 0x85,0x5D, 0x62} };
TNoParam TMsRdpClient8::OptParam;

static inline void ValidCtrCheck(TMsRdpClient8 *)
{
   delete new TMsRdpClient8((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient8::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient8::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient8Disp __fastcall TMsRdpClient8::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient8::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient8::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient8::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient8::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient8::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient8::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient8::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient8::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                   unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient8::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient8::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient8::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                         unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient8::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient8::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient8::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient8::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient8::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient8::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient8::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient8::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient8::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient8::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient8::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient8::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient8::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient8::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient8::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient8::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient8::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient8::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient8::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient9NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 10" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient9NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient9NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x8B918B82, 0x7985, 0x4C24,{ 0x89, 0xDF, 0xC3,0x3A, 0xD2, 0xBB,0xFB, 0xCD} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient9NotSafeForScripting::DEF_CTL_INTF = {0x28904001, 0x04B6, 0x436C,{ 0xA5, 0x5B, 0x0A,0xF1, 0xA0, 0x88,0x3D, 0xC9} };
TNoParam TMsRdpClient9NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient9NotSafeForScripting *)
{
   delete new TMsRdpClient9NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient9NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient9NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient9Disp __fastcall TMsRdpClient9NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient9NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient9NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient9NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient9NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                       BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient9NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                           long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient9NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient9NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient9NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                      unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient9NotSafeForScripting::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient9NotSafeForScripting::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient9NotSafeForScripting::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                                            unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

void __fastcall TMsRdpClient9NotSafeForScripting::SyncSessionDisplaySettings(void)
{
  GetDefaultInterface()->SyncSessionDisplaySettings();
}

void __fastcall TMsRdpClient9NotSafeForScripting::UpdateSessionDisplaySettings(unsigned_long ulDesktopWidth/*[in]*/, 
                                                                               unsigned_long ulDesktopHeight/*[in]*/, 
                                                                               unsigned_long ulPhysicalWidth/*[in]*/, 
                                                                               unsigned_long ulPhysicalHeight/*[in]*/, 
                                                                               unsigned_long ulOrientation/*[in]*/, 
                                                                               unsigned_long ulDesktopScaleFactor/*[in]*/, 
                                                                               unsigned_long ulDeviceScaleFactor/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(ulDesktopWidth/*[in]*/, 
                                                      ulDesktopHeight/*[in]*/, 
                                                      ulPhysicalWidth/*[in]*/, 
                                                      ulPhysicalHeight/*[in]*/, 
                                                      ulOrientation/*[in]*/, 
                                                      ulDesktopScaleFactor/*[in]*/, 
                                                      ulDeviceScaleFactor/*[in]*/);
}

void __fastcall TMsRdpClient9NotSafeForScripting::attachEvent(BSTR eventName/*[in]*/, 
                                                              LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TMsRdpClient9NotSafeForScripting::detachEvent(BSTR eventName/*[in]*/, 
                                                              LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient9NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient9NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient9NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient9NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient9NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient9NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr __fastcall TMsRdpClient9NotSafeForScripting::get_TransportSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr ppXportSet4;
  OLECHECK(GetDefaultInterface()->get_TransportSettings4(&ppXportSet4));
  return ppXportSet4;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient9 which
// allows "Microsoft RDP Client Control (redistributable) - version 10" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient9::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient9::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x301B94BA, 0x5D25, 0x4A12,{ 0xBF, 0xFE, 0x3B,0x6E, 0x7A, 0x61,0x65, 0x85} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient9::DEF_CTL_INTF = {0x28904001, 0x04B6, 0x436C,{ 0xA5, 0x5B, 0x0A,0xF1, 0xA0, 0x88,0x3D, 0xC9} };
TNoParam TMsRdpClient9::OptParam;

static inline void ValidCtrCheck(TMsRdpClient9 *)
{
   delete new TMsRdpClient9((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient9::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient9::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient9Disp __fastcall TMsRdpClient9::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient9::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient9::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient9::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient9::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient9::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                        long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient9::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient9::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient9::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                   unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient9::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient9::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient9::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                         unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

void __fastcall TMsRdpClient9::SyncSessionDisplaySettings(void)
{
  GetDefaultInterface()->SyncSessionDisplaySettings();
}

void __fastcall TMsRdpClient9::UpdateSessionDisplaySettings(unsigned_long ulDesktopWidth/*[in]*/, 
                                                            unsigned_long ulDesktopHeight/*[in]*/, 
                                                            unsigned_long ulPhysicalWidth/*[in]*/, 
                                                            unsigned_long ulPhysicalHeight/*[in]*/, 
                                                            unsigned_long ulOrientation/*[in]*/, 
                                                            unsigned_long ulDesktopScaleFactor/*[in]*/, 
                                                            unsigned_long ulDeviceScaleFactor/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(ulDesktopWidth/*[in]*/, 
                                                      ulDesktopHeight/*[in]*/, 
                                                      ulPhysicalWidth/*[in]*/, 
                                                      ulPhysicalHeight/*[in]*/, 
                                                      ulOrientation/*[in]*/, 
                                                      ulDesktopScaleFactor/*[in]*/, 
                                                      ulDeviceScaleFactor/*[in]*/);
}

void __fastcall TMsRdpClient9::attachEvent(BSTR eventName/*[in]*/, LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TMsRdpClient9::detachEvent(BSTR eventName/*[in]*/, LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient9::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient9::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient9::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient9::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient9::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient9::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient9::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient9::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient9::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient9::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient9::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient9::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient9::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient9::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient9::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient9::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient9::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient9::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient9::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr __fastcall TMsRdpClient9::get_TransportSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr ppXportSet4;
  OLECHECK(GetDefaultInterface()->get_TransportSettings4(&ppXportSet4));
  return ppXportSet4;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient10NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 11" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient10NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient10NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xA0C63C30, 0xF08D, 0x4AB4,{ 0x90, 0x7C, 0x34,0x90, 0x5D, 0x77,0x0C, 0x7D} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient10NotSafeForScripting::DEF_CTL_INTF = {0x7ED92C39, 0xEB38, 0x4927,{ 0xA7, 0x0A, 0x70,0x8A, 0xC5, 0xA5,0x93, 0x21} };
TNoParam TMsRdpClient10NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient10NotSafeForScripting *)
{
   delete new TMsRdpClient10NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient10NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient10NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient10Disp __fastcall TMsRdpClient10NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient10NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient10NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient10NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient10NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                        BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient10NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                            long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient10NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient10NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient10NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                       unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient10NotSafeForScripting::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient10NotSafeForScripting::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient10NotSafeForScripting::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                                             unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

void __fastcall TMsRdpClient10NotSafeForScripting::SyncSessionDisplaySettings(void)
{
  GetDefaultInterface()->SyncSessionDisplaySettings();
}

void __fastcall TMsRdpClient10NotSafeForScripting::UpdateSessionDisplaySettings(unsigned_long ulDesktopWidth/*[in]*/, 
                                                                                unsigned_long ulDesktopHeight/*[in]*/, 
                                                                                unsigned_long ulPhysicalWidth/*[in]*/, 
                                                                                unsigned_long ulPhysicalHeight/*[in]*/, 
                                                                                unsigned_long ulOrientation/*[in]*/, 
                                                                                unsigned_long ulDesktopScaleFactor/*[in]*/, 
                                                                                unsigned_long ulDeviceScaleFactor/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(ulDesktopWidth/*[in]*/, 
                                                      ulDesktopHeight/*[in]*/, 
                                                      ulPhysicalWidth/*[in]*/, 
                                                      ulPhysicalHeight/*[in]*/, 
                                                      ulOrientation/*[in]*/, 
                                                      ulDesktopScaleFactor/*[in]*/, 
                                                      ulDeviceScaleFactor/*[in]*/);
}

void __fastcall TMsRdpClient10NotSafeForScripting::attachEvent(BSTR eventName/*[in]*/, 
                                                               LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TMsRdpClient10NotSafeForScripting::detachEvent(BSTR eventName/*[in]*/, 
                                                               LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient10NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient10NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient10NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient10NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient10NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient10NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_TransportSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr ppXportSet4;
  OLECHECK(GetDefaultInterface()->get_TransportSettings4(&ppXportSet4));
  return ppXportSet4;
}

Mstsclib_tlb::ITSRemoteProgram3Ptr __fastcall TMsRdpClient10NotSafeForScripting::get_RemoteProgram3(void)
{
  Mstsclib_tlb::ITSRemoteProgram3Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram3(&ppRemoteProgram));
  return ppRemoteProgram;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient10 which
// allows "Microsoft RDP Client Control (redistributable) - version 11" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient10::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient10::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xC0EFA91A, 0xEEB7, 0x41C7,{ 0x97, 0xFA, 0xF0,0xED, 0x64, 0x5E,0xFB, 0x24} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient10::DEF_CTL_INTF = {0x7ED92C39, 0xEB38, 0x4927,{ 0xA7, 0x0A, 0x70,0x8A, 0xC5, 0xA5,0x93, 0x21} };
TNoParam TMsRdpClient10::OptParam;

static inline void ValidCtrCheck(TMsRdpClient10 *)
{
   delete new TMsRdpClient10((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient10::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient10::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient10Disp __fastcall TMsRdpClient10::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient10::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient10::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient10::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient10::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient10::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                         long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient10::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient10::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient10::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                    unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient10::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient10::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient10::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                          unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

void __fastcall TMsRdpClient10::SyncSessionDisplaySettings(void)
{
  GetDefaultInterface()->SyncSessionDisplaySettings();
}

void __fastcall TMsRdpClient10::UpdateSessionDisplaySettings(unsigned_long ulDesktopWidth/*[in]*/, 
                                                             unsigned_long ulDesktopHeight/*[in]*/, 
                                                             unsigned_long ulPhysicalWidth/*[in]*/, 
                                                             unsigned_long ulPhysicalHeight/*[in]*/, 
                                                             unsigned_long ulOrientation/*[in]*/, 
                                                             unsigned_long ulDesktopScaleFactor/*[in]*/, 
                                                             unsigned_long ulDeviceScaleFactor/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(ulDesktopWidth/*[in]*/, 
                                                      ulDesktopHeight/*[in]*/, 
                                                      ulPhysicalWidth/*[in]*/, 
                                                      ulPhysicalHeight/*[in]*/, 
                                                      ulOrientation/*[in]*/, 
                                                      ulDesktopScaleFactor/*[in]*/, 
                                                      ulDeviceScaleFactor/*[in]*/);
}

void __fastcall TMsRdpClient10::attachEvent(BSTR eventName/*[in]*/, LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TMsRdpClient10::detachEvent(BSTR eventName/*[in]*/, LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient10::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient10::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient10::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient10::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient10::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient10::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient10::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient10::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient10::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient10::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient10::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient10::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient10::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient10::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient10::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient10::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient10::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient10::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient10::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr __fastcall TMsRdpClient10::get_TransportSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr ppXportSet4;
  OLECHECK(GetDefaultInterface()->get_TransportSettings4(&ppXportSet4));
  return ppXportSet4;
}

Mstsclib_tlb::ITSRemoteProgram3Ptr __fastcall TMsRdpClient10::get_RemoteProgram3(void)
{
  Mstsclib_tlb::ITSRemoteProgram3Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram3(&ppRemoteProgram));
  return ppRemoteProgram;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient11NotSafeForScripting which
// allows "Microsoft RDP Client Control - version 12" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient11NotSafeForScripting::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient11NotSafeForScripting::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x1DF7C823, 0xB2D4, 0x4B54,{ 0x97, 0x5A, 0xF2,0xAC, 0x5D, 0x7C,0xF8, 0xB8} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient11NotSafeForScripting::DEF_CTL_INTF = {0x7ED92C39, 0xEB38, 0x4927,{ 0xA7, 0x0A, 0x70,0x8A, 0xC5, 0xA5,0x93, 0x21} };
TNoParam TMsRdpClient11NotSafeForScripting::OptParam;

static inline void ValidCtrCheck(TMsRdpClient11NotSafeForScripting *)
{
   delete new TMsRdpClient11NotSafeForScripting((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient11NotSafeForScripting::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient11NotSafeForScripting::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient10Disp __fastcall TMsRdpClient11NotSafeForScripting::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient11NotSafeForScripting::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient11NotSafeForScripting::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient11NotSafeForScripting::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient11NotSafeForScripting::SendOnVirtualChannel(BSTR chanName/*[in]*/, 
                                                                        BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient11NotSafeForScripting::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                                            long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient11NotSafeForScripting::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient11NotSafeForScripting::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient11NotSafeForScripting::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                                       unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient11NotSafeForScripting::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient11NotSafeForScripting::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient11NotSafeForScripting::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                                             unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

void __fastcall TMsRdpClient11NotSafeForScripting::SyncSessionDisplaySettings(void)
{
  GetDefaultInterface()->SyncSessionDisplaySettings();
}

void __fastcall TMsRdpClient11NotSafeForScripting::UpdateSessionDisplaySettings(unsigned_long ulDesktopWidth/*[in]*/, 
                                                                                unsigned_long ulDesktopHeight/*[in]*/, 
                                                                                unsigned_long ulPhysicalWidth/*[in]*/, 
                                                                                unsigned_long ulPhysicalHeight/*[in]*/, 
                                                                                unsigned_long ulOrientation/*[in]*/, 
                                                                                unsigned_long ulDesktopScaleFactor/*[in]*/, 
                                                                                unsigned_long ulDeviceScaleFactor/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(ulDesktopWidth/*[in]*/, 
                                                      ulDesktopHeight/*[in]*/, 
                                                      ulPhysicalWidth/*[in]*/, 
                                                      ulPhysicalHeight/*[in]*/, 
                                                      ulOrientation/*[in]*/, 
                                                      ulDesktopScaleFactor/*[in]*/, 
                                                      ulDeviceScaleFactor/*[in]*/);
}

void __fastcall TMsRdpClient11NotSafeForScripting::attachEvent(BSTR eventName/*[in]*/, 
                                                               LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TMsRdpClient11NotSafeForScripting::detachEvent(BSTR eventName/*[in]*/, 
                                                               LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient11NotSafeForScripting::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient11NotSafeForScripting::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient11NotSafeForScripting::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient11NotSafeForScripting::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient11NotSafeForScripting::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient11NotSafeForScripting::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_TransportSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr ppXportSet4;
  OLECHECK(GetDefaultInterface()->get_TransportSettings4(&ppXportSet4));
  return ppXportSet4;
}

Mstsclib_tlb::ITSRemoteProgram3Ptr __fastcall TMsRdpClient11NotSafeForScripting::get_RemoteProgram3(void)
{
  Mstsclib_tlb::ITSRemoteProgram3Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram3(&ppRemoteProgram));
  return ppRemoteProgram;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TMsRdpClient11 which
// allows "Microsoft RDP Client Control (redistributable) - version 12" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TMsRdpClient11::EventDispIDs[32] = {
    0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006,
    0x00000007, 0x00000008, 0x00000009, 0x0000000A, 0x0000000B, 0x0000000C,
    0x0000000D, 0x0000000E, 0x0000000F, 0x00000010, 0x00000011, 0x00000012,
    0x00000013, 0x00000014, 0x00000015, 0x0000001D, 0x00000016, 0x00000017,
    0x00000018, 0x0000001A, 0x0000001C, 0x0000001E, 0x00000020, 0x00000023,
    0x00000021, 0x00000022};

Vcl::Olectrls::TControlData2 TMsRdpClient11::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0x22A7E88C, 0x5BF5, 0x4DE6,{ 0xB6, 0x87, 0x60,0xF7, 0x33, 0x1D,0xF1, 0x90} }, // CoClass
  {0x336D5562, 0xEFA8, 0x482E,{ 0x8C, 0xB3, 0xC5,0xC0, 0xFC, 0x7A,0x7D, 0xB6} }, // Events

  // Count of Events and array of their DISPIDs
  32, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TMsRdpClient11::DEF_CTL_INTF = {0x7ED92C39, 0xEB38, 0x4927,{ 0xA7, 0x0A, 0x70,0x8A, 0xC5, 0xA5,0x93, 0x21} };
TNoParam TMsRdpClient11::OptParam;

static inline void ValidCtrCheck(TMsRdpClient11 *)
{
   delete new TMsRdpClient11((System::Classes::TComponent*)(0));
};

void __fastcall TMsRdpClient11::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TMsRdpClient11::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

IMsRdpClient10Disp __fastcall TMsRdpClient11::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TMsRdpClient11::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TMsRdpClient11::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TMsRdpClient11::CreateVirtualChannels(BSTR newVal/*[in]*/)
{
  GetDefaultInterface()->CreateVirtualChannels(newVal/*[in]*/);
}

void __fastcall TMsRdpClient11::SendOnVirtualChannel(BSTR chanName/*[in]*/, BSTR ChanData/*[in]*/)
{
  GetDefaultInterface()->SendOnVirtualChannel(chanName/*[in]*/, ChanData/*[in]*/);
}

void __fastcall TMsRdpClient11::SetVirtualChannelOptions(BSTR chanName/*[in]*/, 
                                                         long chanOptions/*[in]*/)
{
  GetDefaultInterface()->SetVirtualChannelOptions(chanName/*[in]*/, chanOptions/*[in]*/);
}

long __fastcall TMsRdpClient11::GetVirtualChannelOptions(BSTR chanName/*[in]*/)
{
  long pChanOptions;
  OLECHECK(GetDefaultInterface()->GetVirtualChannelOptions(chanName, (long*)&pChanOptions));
  return pChanOptions;
}

Mstsclib_tlb::ControlCloseStatus __fastcall TMsRdpClient11::RequestClose(void)
{
  Mstsclib_tlb::ControlCloseStatus pCloseStatus;
  OLECHECK(GetDefaultInterface()->RequestClose((Mstsclib_tlb::ControlCloseStatus*)&pCloseStatus));
  return pCloseStatus;
}

BSTR __fastcall TMsRdpClient11::GetErrorDescription(unsigned disconnectReason/*[in]*/, 
                                                    unsigned ExtendedDisconnectReason/*[in]*/)
{
  BSTR pBstrErrorMsg = 0;
  OLECHECK(GetDefaultInterface()->GetErrorDescription(disconnectReason, ExtendedDisconnectReason, (BSTR*)&pBstrErrorMsg));
  return pBstrErrorMsg;
}

BSTR __fastcall TMsRdpClient11::GetStatusText(unsigned statusCode/*[in]*/)
{
  BSTR pBstrStatusText = 0;
  OLECHECK(GetDefaultInterface()->GetStatusText(statusCode, (BSTR*)&pBstrStatusText));
  return pBstrStatusText;
}

void __fastcall TMsRdpClient11::SendRemoteAction(Mstsclib_tlb::RemoteSessionActionType actionType/*[in]*/)
{
  GetDefaultInterface()->SendRemoteAction(actionType/*[in]*/);
}

Mstsclib_tlb::ControlReconnectStatus __fastcall TMsRdpClient11::Reconnect(unsigned_long ulWidth/*[in]*/, 
                                                                          unsigned_long ulHeight/*[in]*/)
{
  Mstsclib_tlb::ControlReconnectStatus pReconnectStatus;
  OLECHECK(GetDefaultInterface()->Reconnect(ulWidth, ulHeight, (Mstsclib_tlb::ControlReconnectStatus*)&pReconnectStatus));
  return pReconnectStatus;
}

void __fastcall TMsRdpClient11::SyncSessionDisplaySettings(void)
{
  GetDefaultInterface()->SyncSessionDisplaySettings();
}

void __fastcall TMsRdpClient11::UpdateSessionDisplaySettings(unsigned_long ulDesktopWidth/*[in]*/, 
                                                             unsigned_long ulDesktopHeight/*[in]*/, 
                                                             unsigned_long ulPhysicalWidth/*[in]*/, 
                                                             unsigned_long ulPhysicalHeight/*[in]*/, 
                                                             unsigned_long ulOrientation/*[in]*/, 
                                                             unsigned_long ulDesktopScaleFactor/*[in]*/, 
                                                             unsigned_long ulDeviceScaleFactor/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(ulDesktopWidth/*[in]*/, 
                                                      ulDesktopHeight/*[in]*/, 
                                                      ulPhysicalWidth/*[in]*/, 
                                                      ulPhysicalHeight/*[in]*/, 
                                                      ulOrientation/*[in]*/, 
                                                      ulDesktopScaleFactor/*[in]*/, 
                                                      ulDeviceScaleFactor/*[in]*/);
}

void __fastcall TMsRdpClient11::attachEvent(BSTR eventName/*[in]*/, LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TMsRdpClient11::detachEvent(BSTR eventName/*[in]*/, LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IMsTscSecuredSettingsPtr __fastcall TMsRdpClient11::get_SecuredSettings(void)
{
  Mstsclib_tlb::IMsTscSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsTscAdvancedSettingsPtr __fastcall TMsRdpClient11::get_AdvancedSettings(void)
{
  Mstsclib_tlb::IMsTscAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsTscDebugPtr __fastcall TMsRdpClient11::get_Debugger(void)
{
  Mstsclib_tlb::IMsTscDebugPtr ppDebugger;
  OLECHECK(GetDefaultInterface()->get_Debugger(&ppDebugger));
  return ppDebugger;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr __fastcall TMsRdpClient11::get_AdvancedSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettingsPtr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings2(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr __fastcall TMsRdpClient11::get_SecuredSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettingsPtr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings2(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr __fastcall TMsRdpClient11::get_AdvancedSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings2Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings3(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr __fastcall TMsRdpClient11::get_AdvancedSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings3Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings4(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr __fastcall TMsRdpClient11::get_AdvancedSettings5(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings4Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings5(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettingsPtr __fastcall TMsRdpClient11::get_TransportSettings(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettingsPtr ppXportSet;
  OLECHECK(GetDefaultInterface()->get_TransportSettings(&ppXportSet));
  return ppXportSet;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr __fastcall TMsRdpClient11::get_AdvancedSettings6(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings5Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings6(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::ITSRemoteProgramPtr __fastcall TMsRdpClient11::get_RemoteProgram(void)
{
  Mstsclib_tlb::ITSRemoteProgramPtr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientShellPtr __fastcall TMsRdpClient11::get_MsRdpClientShell(void)
{
  Mstsclib_tlb::IMsRdpClientShellPtr ppLauncher;
  OLECHECK(GetDefaultInterface()->get_MsRdpClientShell(&ppLauncher));
  return ppLauncher;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr __fastcall TMsRdpClient11::get_AdvancedSettings7(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings6Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings7(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr __fastcall TMsRdpClient11::get_TransportSettings2(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings2Ptr ppXportSet2;
  OLECHECK(GetDefaultInterface()->get_TransportSettings2(&ppXportSet2));
  return ppXportSet2;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr __fastcall TMsRdpClient11::get_AdvancedSettings8(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings7Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings8(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr __fastcall TMsRdpClient11::get_TransportSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings3Ptr ppXportSet3;
  OLECHECK(GetDefaultInterface()->get_TransportSettings3(&ppXportSet3));
  return ppXportSet3;
}

Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr __fastcall TMsRdpClient11::get_SecuredSettings3(void)
{
  Mstsclib_tlb::IMsRdpClientSecuredSettings2Ptr ppSecuredSettings;
  OLECHECK(GetDefaultInterface()->get_SecuredSettings3(&ppSecuredSettings));
  return ppSecuredSettings;
}

Mstsclib_tlb::ITSRemoteProgram2Ptr __fastcall TMsRdpClient11::get_RemoteProgram2(void)
{
  Mstsclib_tlb::ITSRemoteProgram2Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram2(&ppRemoteProgram));
  return ppRemoteProgram;
}

Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr __fastcall TMsRdpClient11::get_AdvancedSettings9(void)
{
  Mstsclib_tlb::IMsRdpClientAdvancedSettings8Ptr ppAdvSettings;
  OLECHECK(GetDefaultInterface()->get_AdvancedSettings9(&ppAdvSettings));
  return ppAdvSettings;
}

Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr __fastcall TMsRdpClient11::get_TransportSettings4(void)
{
  Mstsclib_tlb::IMsRdpClientTransportSettings4Ptr ppXportSet4;
  OLECHECK(GetDefaultInterface()->get_TransportSettings4(&ppXportSet4));
  return ppXportSet4;
}

Mstsclib_tlb::ITSRemoteProgram3Ptr __fastcall TMsRdpClient11::get_RemoteProgram3(void)
{
  Mstsclib_tlb::ITSRemoteProgram3Ptr ppRemoteProgram;
  OLECHECK(GetDefaultInterface()->get_RemoteProgram3(&ppRemoteProgram));
  return ppRemoteProgram;
}



// *********************************************************************//
// OCX PROXY CLASS IMPLEMENTATION
// (The following variables/methods implement the class TRemoteDesktopClient which
// allows "Microsoft Windows Store App Remote Desktop Client Control - version 1" to be hosted in CBuilder IDE/apps).
// *********************************************************************//
int   TRemoteDesktopClient::EventDispIDs[14] = {
    0x000002EE, 0x000002EF, 0x000002F0, 0x000002F1, 0x000002F2, 0x000002F3,
    0x000002F4, 0x000002F5, 0x000002F6, 0x000002F7, 0x000002F8, 0x000002F9,
    0x000002FA, 0x00000320};

Vcl::Olectrls::TControlData2 TRemoteDesktopClient::CControlData =
{
  // GUID of CoClass and Event Interface of Control
  {0xEAB16C5D, 0xEED1, 0x4E95,{ 0x86, 0x8B, 0x0F,0xBA, 0x1B, 0x42,0xC0, 0x92} }, // CoClass
  {0x079863B7, 0x6D47, 0x4105,{ 0x8B, 0xFE, 0x0C,0xDC, 0xB3, 0x60,0xE6, 0x7D} }, // Events

  // Count of Events and array of their DISPIDs
  14, &EventDispIDs,

  // Pointer to Runtime License string
  NULL,  // HRESULT(0x80040111)

  // Flags for OnChanged PropertyNotification
  0x00000000,
  401,// (IDE Version)

  // Count of Font Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),

  // Count of Pict Prop and array of their DISPIDs
  0, Winapi::Activex::PDispIDList(NULL),
  0, // Reserved
  0, // Instance count (used internally)
  0, // List of Enum descriptions (internal)
};

GUID     TRemoteDesktopClient::DEF_CTL_INTF = {0x57D25668, 0x625A, 0x4905,{ 0xBE, 0x4E, 0x30,0x4C, 0xAA, 0x13,0xF8, 0x9C} };
TNoParam TRemoteDesktopClient::OptParam;

static inline void ValidCtrCheck(TRemoteDesktopClient *)
{
   delete new TRemoteDesktopClient((System::Classes::TComponent*)(0));
};

void __fastcall TRemoteDesktopClient::InitControlData()
{
  ControlData = (Vcl::Olectrls::TControlData*)&CControlData;
  CControlData.FirstEventOfs = System::PByte(&FOnConnecting) - System::PByte(this);
};

void __fastcall TRemoteDesktopClient::CreateControl()
{
  if (!m_OCXIntf)
  {
    _ASSERTE(DefaultDispatch);
    DefaultDispatch->QueryInterface(DEF_CTL_INTF, (LPVOID*)&m_OCXIntf);
  }
};

TCOMIRemoteDesktopClient __fastcall TRemoteDesktopClient::GetDefaultInterface()
{
  CreateControl();
  return m_OCXIntf;
};

void __fastcall TRemoteDesktopClient::Connect(void)
{
  GetDefaultInterface()->Connect();
}

void __fastcall TRemoteDesktopClient::Disconnect(void)
{
  GetDefaultInterface()->Disconnect();
}

void __fastcall TRemoteDesktopClient::Reconnect(unsigned_long width/*[in]*/, 
                                                unsigned_long height/*[in]*/)
{
  GetDefaultInterface()->Reconnect(width/*[in]*/, height/*[in]*/);
}

void __fastcall TRemoteDesktopClient::DeleteSavedCredentials(BSTR serverName/*[in]*/)
{
  GetDefaultInterface()->DeleteSavedCredentials(serverName/*[in]*/);
}

void __fastcall TRemoteDesktopClient::UpdateSessionDisplaySettings(unsigned_long width/*[in]*/, 
                                                                   unsigned_long height/*[in]*/)
{
  GetDefaultInterface()->UpdateSessionDisplaySettings(width/*[in]*/, height/*[in]*/);
}

void __fastcall TRemoteDesktopClient::attachEvent(BSTR eventName/*[in]*/, 
                                                  LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->attachEvent(eventName/*[in]*/, callback/*[in]*/);
}

void __fastcall TRemoteDesktopClient::detachEvent(BSTR eventName/*[in]*/, 
                                                  LPDISPATCH callback/*[in]*/)
{
  GetDefaultInterface()->detachEvent(eventName/*[in]*/, callback/*[in]*/);
}

Mstsclib_tlb::IRemoteDesktopClientSettingsPtr __fastcall TRemoteDesktopClient::get_Settings(void)
{
  Mstsclib_tlb::IRemoteDesktopClientSettingsPtr Settings;
  OLECHECK(GetDefaultInterface()->get_Settings(&Settings));
  return Settings;
}

Mstsclib_tlb::IRemoteDesktopClientActionsPtr __fastcall TRemoteDesktopClient::get_Actions(void)
{
  Mstsclib_tlb::IRemoteDesktopClientActionsPtr Actions;
  OLECHECK(GetDefaultInterface()->get_Actions(&Actions));
  return Actions;
}

Mstsclib_tlb::IRemoteDesktopClientTouchPointerPtr __fastcall TRemoteDesktopClient::get_TouchPointer(void)
{
  Mstsclib_tlb::IRemoteDesktopClientTouchPointerPtr TouchPointer;
  OLECHECK(GetDefaultInterface()->get_TouchPointer(&TouchPointer));
  return TouchPointer;
}


};     // namespace Mstsclib_tlb


// *********************************************************************//
// The Register function is invoked by the IDE when this module is 
// installed in a Package. It provides the list of Components (including
// OCXes) implemented by this module. The following implementation
// informs the IDE of the OCX proxy classes implemented here.
// *********************************************************************//
namespace Mstsclib_ocx
{

void __fastcall PACKAGE Register()
{
  // [26]
  System::Classes::TComponentClass cls_ocx[] = {
                              __classid(Mstsclib_tlb::TMsTscAxNotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClientNotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient2NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient2), 
                              __classid(Mstsclib_tlb::TMsRdpClient2a), 
                              __classid(Mstsclib_tlb::TMsRdpClient3NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient3), 
                              __classid(Mstsclib_tlb::TMsRdpClient3a), 
                              __classid(Mstsclib_tlb::TMsRdpClient4NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient4), 
                              __classid(Mstsclib_tlb::TMsRdpClient4a), 
                              __classid(Mstsclib_tlb::TMsRdpClient5NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient5), 
                              __classid(Mstsclib_tlb::TMsRdpClient6NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient6), 
                              __classid(Mstsclib_tlb::TMsRdpClient7NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient7), 
                              __classid(Mstsclib_tlb::TMsRdpClient8NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient8), 
                              __classid(Mstsclib_tlb::TMsRdpClient9NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient9), 
                              __classid(Mstsclib_tlb::TMsRdpClient10NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient10), 
                              __classid(Mstsclib_tlb::TMsRdpClient11NotSafeForScripting), 
                              __classid(Mstsclib_tlb::TMsRdpClient11), 
                              __classid(Mstsclib_tlb::TRemoteDesktopClient)
                           };
  System::Classes::RegisterComponents("RDPDelphi", cls_ocx,
                     sizeof(cls_ocx)/sizeof(cls_ocx[0])-1);
  // [2]
  System::Classes::TComponentClass cls_svr[] = {
                              __classid(Mstsclib_tlb::TMsTscAx), 
                              __classid(Mstsclib_tlb::TMsRdpClient)
                           };
  System::Classes::RegisterComponents("RDPDelphi", cls_svr,
                     sizeof(cls_svr)/sizeof(cls_svr[0])-1);
}

};     // namespace Mstsclib_ocx
